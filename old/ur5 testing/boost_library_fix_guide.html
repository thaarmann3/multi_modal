<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UR5 RTDE Boost Library Fix Guide - MacBook Pro M1 Max</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
            color: #333;
        }
        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(0,0,0,0.1);
        }
        h1 {
            color: #2c3e50;
            border-bottom: 3px solid #3498db;
            padding-bottom: 10px;
        }
        h2 {
            color: #34495e;
            margin-top: 30px;
            border-left: 4px solid #3498db;
            padding-left: 15px;
        }
        h3 {
            color: #7f8c8d;
            margin-top: 25px;
        }
        .error-box {
            background-color: #fdf2f2;
            border: 1px solid #fecaca;
            border-left: 4px solid #ef4444;
            padding: 15px;
            margin: 15px 0;
            border-radius: 5px;
        }
        .success-box {
            background-color: #f0fdf4;
            border: 1px solid #bbf7d0;
            border-left: 4px solid #22c55e;
            padding: 15px;
            margin: 15px 0;
            border-radius: 5px;
        }
        .warning-box {
            background-color: #fffbeb;
            border: 1px solid #fed7aa;
            border-left: 4px solid #f59e0b;
            padding: 15px;
            margin: 15px 0;
            border-radius: 5px;
        }
        .info-box {
            background-color: #eff6ff;
            border: 1px solid #bfdbfe;
            border-left: 4px solid #3b82f6;
            padding: 15px;
            margin: 15px 0;
            border-radius: 5px;
        }
        code {
            background-color: #f1f5f9;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
            color: #e11d48;
        }
        pre {
            background-color: #1e293b;
            color: #e2e8f0;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
            margin: 15px 0;
        }
        pre code {
            background: none;
            color: inherit;
            padding: 0;
        }
        .command {
            background-color: #1e293b;
            color: #e2e8f0;
            padding: 10px 15px;
            border-radius: 5px;
            font-family: 'Courier New', monospace;
            margin: 10px 0;
            border-left: 4px solid #3b82f6;
        }
        .step {
            background-color: #f8fafc;
            border: 1px solid #e2e8f0;
            padding: 15px;
            margin: 10px 0;
            border-radius: 5px;
            border-left: 4px solid #6366f1;
        }
        .step-number {
            background-color: #6366f1;
            color: white;
            padding: 5px 10px;
            border-radius: 50%;
            font-weight: bold;
            margin-right: 10px;
        }
        ul, ol {
            padding-left: 20px;
        }
        li {
            margin: 8px 0;
        }
        .toc {
            background-color: #f8fafc;
            border: 1px solid #e2e8f0;
            padding: 20px;
            border-radius: 5px;
            margin: 20px 0;
        }
        .toc h3 {
            margin-top: 0;
            color: #374151;
        }
        .toc ul {
            list-style-type: none;
            padding-left: 0;
        }
        .toc li {
            margin: 5px 0;
        }
        .toc a {
            text-decoration: none;
            color: #3b82f6;
        }
        .toc a:hover {
            text-decoration: underline;
        }
        .footer {
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid #e2e8f0;
            text-align: center;
            color: #6b7280;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üîß UR5 RTDE Boost Library Fix Guide</h1>
        <h2 style="color: #e74c3c; margin-top: 0;">üçé MacBook Pro M1 Max (Apple Silicon)</h2>
        
        <div class="info-box">
            <strong>üìã Overview:</strong> This guide explains how to fix the common Boost library compatibility issue when using the UR5 RTDE (Real-Time Data Exchange) Python package on <strong>MacBook Pro M1 Max</strong> with Homebrew on Apple Silicon (ARM64).
        </div>

        <div class="success-box">
            <strong>üñ•Ô∏è System Specifications:</strong><br>
            ‚Ä¢ <strong>Device:</strong> MacBook Pro with Apple M1 Max chip<br>
            ‚Ä¢ <strong>Architecture:</strong> ARM64 (Apple Silicon)<br>
            ‚Ä¢ <strong>Package Manager:</strong> Homebrew (ARM64 version)<br>
            ‚Ä¢ <strong>Python:</strong> Python 3.12 (ARM64)<br>
            ‚Ä¢ <strong>Boost Library Path:</strong> <code>/opt/homebrew/opt/boost/lib/</code>
        </div>

        <div class="toc">
            <h3>üìë Table of Contents</h3>
            <ul>
                <li><a href="#problem">1. Understanding the Problem</a></li>
                <li><a href="#error-message">2. Error Message Analysis</a></li>
                <li><a href="#root-cause">3. Root Cause Explanation</a></li>
                <li><a href="#solution">4. The Fix (Symbolic Link)</a></li>
                <li><a href="#verification">5. Verification Steps</a></li>
                <li><a href="#uninstall">6. How to Uninstall/Undo the Fix</a></li>
                <li><a href="#alternatives">7. Alternative Solutions</a></li>
                <li><a href="#troubleshooting">8. Troubleshooting</a></li>
                <li><a href="#faq">9. Frequently Asked Questions</a></li>
            </ul>
        </div>

        <h2 id="problem">1. Understanding the Problem</h2>
        
        <p>When trying to use the <code>ur-rtde</code> Python package with UR5 robots on your <strong>MacBook Pro M1 Max</strong>, you may encounter a library loading error related to Boost C++ libraries. This is a common compatibility issue between different versions of the Boost library system, particularly on Apple Silicon Macs where Homebrew uses the ARM64 architecture.</p>

        <div class="error-box">
            <strong>üö® Typical Error:</strong><br>
            The error occurs when Python tries to import <code>rtde_receive</code> or <code>rtde_control</code> modules and fails to load the required Boost system library.
        </div>

        <h2 id="error-message">2. Error Message Analysis</h2>

        <p>Here's what the error typically looks like:</p>

        <pre><code>ImportError: dlopen(/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/rtde_receive.cpython-312-darwin.so, 0x0002): Library not loaded: /opt/homebrew/opt/boost/lib/libboost_system.dylib
  Referenced from: <1B7B00FA-3ECC-33C4-813E-B3B48F022179> /Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/rtde_receive.cpython-312-darwin.so
  Reason: tried: '/opt/homebrew/opt/boost/lib/libboost_system.dylib' (no such file), '/System/Volumes/Preboot/Cryptexes/OS/opt/homebrew/opt/boost/lib/libboost_system.dylib' (no such file), '/opt/homebrew/opt/boost/lib/libboost_system.dylib' (no such file), '/opt/homebrew/Cellar/boost/1.89.0/lib/libboost_system.dylib' (no such file)</code></pre>

        <div class="info-box">
            <strong>üîç What this means on your M1 Max:</strong><br>
            ‚Ä¢ Python is trying to load a compiled ARM64 module (<code>rtde_receive.cpython-312-darwin.so</code>)<br>
            ‚Ä¢ This module was compiled against an older version of Boost that included <code>libboost_system.dylib</code><br>
            ‚Ä¢ Your current Boost 1.89.0 installation (ARM64) doesn't have this separate library file<br>
            ‚Ä¢ The dynamic linker searches multiple paths including <code>/opt/homebrew/</code> (Apple Silicon Homebrew)<br>
            ‚Ä¢ The import fails because the required library is missing
        </div>

        <h2 id="root-cause">3. Root Cause Explanation</h2>

        <h3>Version Compatibility Issue on M1 Max</h3>
        <ul>
            <li><strong>UR-RTDE Package:</strong> Compiled against Boost 1.76 or earlier (ARM64 version)</li>
            <li><strong>Your M1 Max System:</strong> Has Boost 1.89.0 (ARM64, newer version)</li>
            <li><strong>The Problem:</strong> Boost 1.77+ merged <code>boost_system</code> functionality into other libraries</li>
            <li><strong>Apple Silicon Specific:</strong> Homebrew on M1 Max uses <code>/opt/homebrew/</code> instead of <code>/usr/local/</code></li>
        </ul>

        <h3>Library Structure Changes</h3>
        <div class="step">
            <strong>Old Boost (‚â§1.76):</strong>
            <ul>
                <li><code>libboost_system.dylib</code> - Separate system library</li>
                <li><code>libboost_filesystem.dylib</code> - File system operations</li>
                <li><code>libboost_thread.dylib</code> - Threading support</li>
            </ul>
        </div>

        <div class="step">
            <strong>New Boost (‚â•1.77):</strong>
            <ul>
                <li><code>libboost_filesystem.dylib</code> - Now includes system functionality</li>
                <li><code>libboost_thread.dylib</code> - Threading support</li>
                <li><em>No separate <code>libboost_system.dylib</code></em></li>
            </ul>
        </div>

        <h2 id="solution">4. The Fix (Symbolic Link)</h2>

        <div class="success-box">
            <strong>‚úÖ Solution:</strong> Create a symbolic link from the missing library to an existing compatible library.
        </div>

        <div class="step">
            <span class="step-number">1</span>
            <strong>Check your Boost installation on M1 Max:</strong>
            <div class="command">brew list boost</div>
            <p><em>Should show: <code>boost: stable 1.89.0 (bottled)</code></em></p>
        </div>

        <div class="step">
            <span class="step-number">2</span>
            <strong>Verify the missing library on Apple Silicon:</strong>
            <div class="command">ls -la /opt/homebrew/opt/boost/lib/ | grep system</div>
            <p><em>This should show no results, confirming the library is missing. On M1 Max, Homebrew uses <code>/opt/homebrew/</code> instead of <code>/usr/local/</code>.</em></p>
        </div>

        <div class="step">
            <span class="step-number">3</span>
            <strong>Create the symbolic link for M1 Max:</strong>
            <div class="command">sudo ln -sf /opt/homebrew/opt/boost/lib/libboost_filesystem.dylib /opt/homebrew/opt/boost/lib/libboost_system.dylib</div>
            <p><em>Note: This uses the Apple Silicon Homebrew path <code>/opt/homebrew/</code> instead of the Intel path <code>/usr/local/</code>.</em></p>
        </div>

        <div class="step">
            <span class="step-number">4</span>
            <strong>Verify the fix on your M1 Max:</strong>
            <div class="command">ls -la /opt/homebrew/opt/boost/lib/libboost_system.dylib</div>
            <p><em>Expected output: <code>lrwxr-xr-x@ 1 root admin 53 [date] libboost_system.dylib -> libboost_filesystem.dylib</code></em></p>
            <p><em>The <code>l</code> at the beginning indicates it's a symbolic link, and the <code>-></code> shows what it points to.</em></p>
        </div>

        <h3>Command Breakdown for M1 Max</h3>
        <ul>
            <li><code>sudo</code> - Run with administrator privileges (required for system library changes)</li>
            <li><code>ln</code> - Create a link</li>
            <li><code>-s</code> - Create a symbolic link (not hard link)</li>
            <li><code>-f</code> - Force overwrite if the target already exists</li>
            <li><code>/opt/homebrew/opt/boost/lib/libboost_filesystem.dylib</code> - Source (existing ARM64 library)</li>
            <li><code>/opt/homebrew/opt/boost/lib/libboost_system.dylib</code> - Target (missing library name)</li>
        </ul>
        
        <div class="info-box">
            <strong>üçé Apple Silicon Specific Notes:</strong><br>
            ‚Ä¢ <code>/opt/homebrew/</code> is the ARM64 Homebrew installation path<br>
            ‚Ä¢ Intel Macs use <code>/usr/local/</code> for Homebrew<br>
            ‚Ä¢ The <code>@</code> symbol in file listings indicates extended attributes (common on macOS)<br>
            ‚Ä¢ All libraries are ARM64 compiled for optimal M1 Max performance
        </div>

        <h2 id="verification">5. Verification Steps</h2>

        <div class="step">
            <span class="step-number">1</span>
            <strong>Test Python import:</strong>
            <div class="command">python3 -c "import rtde_receive; print('‚úÖ Success!')"</div>
        </div>

        <div class="step">
            <span class="step-number">2</span>
            <strong>Test your UR5 script:</strong>
            <div class="command">python3 force_monitor.py</div>
        </div>

        <div class="step">
            <span class="step-number">3</span>
            <strong>Check the symbolic link on M1 Max:</strong>
            <div class="command">ls -la /opt/homebrew/opt/boost/lib/libboost_system.dylib</div>
            <p><em>Expected output: <code>lrwxr-xr-x@ 1 root admin 53 [date] libboost_system.dylib -> libboost_filesystem.dylib</code></em></p>
            <p><em>The <code>@</code> symbol indicates extended attributes, which is normal on macOS.</em></p>
        </div>

        <h2 id="uninstall">6. How to Uninstall/Undo the Fix</h2>

        <div class="warning-box">
            <strong>‚ö†Ô∏è Note:</strong> You only need to undo this fix if you want to use a different solution or if it causes issues.
        </div>

        <div class="step">
            <span class="step-number">1</span>
            <strong>Remove the symbolic link:</strong>
            <div class="command">sudo rm /opt/homebrew/opt/boost/lib/libboost_system.dylib</div>
        </div>

        <div class="step">
            <span class="step-number">2</span>
            <strong>Verify removal:</strong>
            <div class="command">ls -la /opt/homebrew/opt/boost/lib/ | grep system</div>
            <p><em>This should show no results, confirming the link is removed.</em></p>
        </div>

        <div class="step">
            <span class="step-number">3</span>
            <strong>Test that the error returns:</strong>
            <div class="command">python3 -c "import rtde_receive"</div>
            <p><em>You should see the original ImportError again.</em></p>
        </div>

        <h2 id="alternatives">7. Alternative Solutions</h2>

        <h3>Option 1: Downgrade Boost (Not Recommended)</h3>
        <div class="warning-box">
            <strong>‚ö†Ô∏è Warning:</strong> This may break other software that depends on the newer Boost version.
        </div>
        <div class="command">brew uninstall boost<br>brew install boost@1.76</div>

        <h3>Option 2: Use Virtual Environment with Older Boost (M1 Max Compatible)</h3>
        <div class="command"># Create a new environment with ARM64 support<br>conda create -n ur5-old-boost python=3.9<br>conda activate ur5-old-boost<br>conda install boost=1.76<br>pip install ur-rtde</div>
        <p><em>Note: Make sure you're using the ARM64 version of conda for optimal M1 Max performance.</em></p>

        <h3>Option 3: Compile UR-RTDE from Source</h3>
        <div class="command">pip uninstall ur-rtde<br>pip install --no-binary=ur-rtde ur-rtde</div>

        <h2 id="troubleshooting">8. Troubleshooting</h2>

        <h3>Problem: "Permission denied" when creating symlink</h3>
        <p><strong>Solution:</strong> Make sure you're using <code>sudo</code> and have administrator privileges.</p>

        <h3>Problem: Symlink created but still getting errors</h3>
        <p><strong>Check:</strong></p>
        <ul>
            <li>Verify the symlink points to the correct file</li>
            <li>Ensure the target library exists</li>
            <li>Check file permissions</li>
        </ul>
        <div class="command">ls -la /opt/homebrew/opt/boost/lib/libboost_system.dylib</div>

        <h3>Problem: Different Python environment on M1 Max</h3>
        <p><strong>Solution:</strong> Make sure you're using the same Python environment where ur-rtde is installed. On M1 Max, you might have multiple Python installations.</p>
        <div class="command">which python3<br>python3 -c "import sys; print(sys.path)"<br>python3 -c "import platform; print(f'Architecture: {platform.machine()}')"</div>
        <p><em>Make sure the architecture shows <code>arm64</code> for optimal M1 Max performance.</em></p>

        <h2 id="faq">9. Frequently Asked Questions</h2>

        <h3>Q: Is this fix permanent?</h3>
        <p><strong>A:</strong> Yes, the symbolic link will persist until you explicitly remove it. It survives system updates and reboots.</p>

        <h3>Q: Is this safe for my system?</h3>
        <p><strong>A:</strong> Yes, it's completely safe. We're only creating a link, not modifying system files. The boost_filesystem library contains the functionality that boost_system used to provide.</p>

        <h3>Q: Will this affect other software?</h3>
        <p><strong>A:</strong> No, this fix only affects software that specifically looks for libboost_system.dylib. Most modern software uses the newer Boost structure.</p>

        <h3>Q: What if I update Boost?</h3>
        <p><strong>A:</strong> The symlink will continue to work. If you reinstall Boost, you may need to recreate the symlink.</p>

        <h3>Q: Can I use this on Intel Macs or Linux?</h3>
        <p><strong>A:</strong> The concept is the same, but the paths will be different:</p>
        <ul>
            <li><strong>Intel Macs:</strong> Use <code>/usr/local/opt/boost/lib/</code> instead of <code>/opt/homebrew/opt/boost/lib/</code></li>
            <li><strong>Linux:</strong> Boost libraries are typically in <code>/usr/lib/</code> or <code>/usr/local/lib/</code></li>
            <li><strong>M1 Max (this guide):</strong> Uses <code>/opt/homebrew/opt/boost/lib/</code> (Apple Silicon Homebrew)</li>
        </ul>

        <h3>Q: Why not just recompile ur-rtde?</h3>
        <p><strong>A:</strong> Recompiling requires the full Boost development environment and can be complex. The symlink solution is simpler and equally effective.</p>

        <div class="footer">
            <p><strong>üìù Documentation created:</strong> September 2024</p>
            <p><strong>üîß For UR5 RTDE Python Package Compatibility Issues</strong></p>
            <p><strong>üçé Specifically tailored for MacBook Pro M1 Max (Apple Silicon)</strong></p>
            <p><em>This guide provides a permanent, safe solution for Boost library compatibility issues when using UR5 robots with Python on Apple Silicon Macs.</em></p>
        </div>
    </div>
</body>
</html>
